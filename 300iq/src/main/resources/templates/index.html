<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>청주 부동산 분석 게시판</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Malgun Gothic", "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif; margin: 0; padding: 0; background-color: #f9f9f9; }
        .container { padding: 20px; max-width: 1400px; margin: auto; }
        h1, h2 { border-bottom: 2px solid #eee; padding-bottom: 5px; }
        table { border-collapse: collapse; margin-bottom: 30px; width: 100%; background-color: #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; font-size: 0.9em; }
        th { background-color: #f7f7f7; }
        .data-layout { display: flex; flex-wrap: wrap; gap: 30px; }
        .data-section { flex: 1; min-width: 450px; }
    </style>
</head>
<body>

<nav th:replace="~{fragments/header :: headerFragment}"></nav>

<div class="container">
    <h1>청주시 부동산 데이터 현황</h1>
    <p>이 데이터는 앱 실행 시 `src/main/resources/csv/` 폴더의 파일들을 읽어 MySQL에 저장된 정보입니다.</p>
    
    <div class="data-layout">
        
        <div class="data-section">
            <h2>최근 실거래가 (Top 20)</h2>
            <table th:if="${!transactions.isEmpty()}">
                <thead>
                    <tr> <th>유형</th> <th>주소</th> <th>단지명</th> <th>거래가(만)</th> <th>월세(만)</th> </tr>
                </thead>
                <tbody>
                    <tr th:each="tx : ${transactions}">
                        <td th:text="${tx.transactionType}">아파트(매매)</td>
                        <td th:text="${tx.address}">청주시 흥덕구</td>
                        <td th:text="${tx.buildingName}">OO아파트</td>
                        <td th:text="${tx.price}">50000</td>
                        <td th:text="${tx.rent}">0</td>
                    </tr>
                </tbody>
            </table>
            <div th:if="${transactions.isEmpty()}">
                <p>최근 실거래가 데이터가 없습니다. (DB 적재 확인 필요)</p>
            </div>
        </div>

        <div class="data-section">
            <h2>서원구 아파트 매매가격지수</h2>
            <table th:if="${!priceIndices.isEmpty()}">
                <thead><tr><th>년월</th><th>지수</th></tr></thead>
                <tbody>
                    <tr th:each="index, iterStat : ${priceIndices}" th:if="${iterStat.size - iterStat.index <= 12}">
                        <td th:text="${index.yearMonth}">202509</td>
                        <td th:text="${index.value}">101.5</td>
                    </tr>
                </tbody>
            </table>

            <h2>흥덕구 지가지수</h2>
            <table th:if="${!landIndices.isEmpty()}">
                <thead><tr><th>년월</th><th>지수</th></tr></thead>
                <tbody>
                    <tr th:each="index, iterStat : ${landIndices}" th:if="${iterStat.size - iterStat.index <= 12}">
                        <td th:text="${index.yearMonth}">202509</td>
                        <td th:text="${index.value}">102.2</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

</body>
</html>